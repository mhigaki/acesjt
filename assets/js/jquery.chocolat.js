(function(b){images=[];var p=0;b.fn.Chocolat=function(a){function q(b){a.currentImage=b.data.i;a.setIndex=b.data.id;a.setTitle=b.data.nom;a.lastImage=images[a.setIndex].length-1;r();return!1}function t(){b("#Choco_overlay").remove();b("#Choco_content").remove();a.container.append('<div id="Choco_overlay"></div><div id="Choco_content"><div id="Choco_close"></div><div id="Choco_loading"></div><div id="Choco_container_photo"><img id="Choco_bigImage" src="" /></div><div id="Choco_container_description"><span id="Choco_container_title"></span><span id="Choco_container_via"></span></div><div id="Choco_left_arrow" class="Choco_arrows"></div><div id="Choco_right_arrow" class="Choco_arrows"></div></div>');
b("#Choco_left_arrow").css("background-image","url("+a.leftImg+")");b("#Choco_right_arrow").css("background-image","url("+a.rightImg+")");b("#Choco_close").css("background-image","url("+a.closeImg+")");b("#Choco_loading").css("background-image","url("+a.loadingImg+")");"body"!==a.container.get(0).nodeName.toLowerCase()&&(a.container.css({position:"relative",overflow:"hidden","line-height":"normal"}),b("#Choco_content").css("position","relative"),b("#Choco_overlay").css("position","absolute"));b(document).unbind("keydown").bind("keydown",
function(a){switch(a.keyCode){case 37:g(-1);break;case 39:g(1);break;case 27:k()}});a.vache&&b("#Choco_overlay").click(function(){k();return!1});b("#Choco_left_arrow").unbind().bind("click",function(){g(-1);return!1});b("#Choco_right_arrow").unbind().bind("click",function(){g(1);return!1});b("#Choco_close").unbind().bind("click",function(){k();return!1});b(window).resize(function(){l(a.currentImage,!0)})}function r(){t();l(a.currentImage,!1);b("#Choco_overlay").css({"background-color":a.overlayColor,
opacity:a.overlayOpacity}).fadeIn(a.fadeInOverlayduration);b("#Choco_content").fadeIn(a.fadeInImageduration,function(){})}function l(c,h){a.currentImage=c;b("#Choco_loading").fadeIn(a.fadeInImageduration);var n=new Image;n.onload=function(){b("#Choco_bigImage").attr("src",images[a.setIndex][a.currentImage].adress);var c;c=n.height;var d=n.width,g,f=b("#Choco_container_description").height()+b("#Choco_close").height(),k,l=d/c,m=c/d;"body"==a.container.get(0).nodeName.toLowerCase()?(windowHeight=b(window).height(),
windowWidth=b(window).width()):(windowHeight=a.container.height(),windowWidth=a.container.width());for(notFitting=!0;notFitting;)g=d+28*d/100,k=c+f,g>windowWidth?(d=100*windowWidth/128,c=m*d):k>windowHeight?(c=windowHeight-f,d=l*c):notFitting=!1;c={largeur:d,hauteur:c};u(c.hauteur,c.largeur,h);b("#Choco_loading").stop().fadeOut(a.fadeOutImageduration)};n.src=images[a.setIndex][a.currentImage].adress;a.currentImage!==a.lastImage&&(f=new Image,z=a.currentImage+1,f.src=images[a.setIndex][z].adress);
v()}function g(c){if(!a.linkImages||0==a.currentImage&&-1==c||a.currentImage==a.lastImage&&1==c)return!1;b("#Choco_container_description").css("visibility","hidden");b("#Choco_bigImage").fadeTo(a.fadeOutImageduration,0,function(){l(a.currentImage+parseInt(c),!1)})}function u(c,h,g){g&&(b("#Choco_container_photo, #Choco_content, #Choco_bigImage").stop(!0,!1).css({overflow:"visible"}),b("#Choco_bigImage").animate({height:c+"px",width:h+"px"},a.fadeInImageduration));b("#Choco_container_photo").animate({height:c,
width:h},a.fadeInImageduration);b("#Choco_content").animate({height:c,width:h,marginLeft:-h/2,marginTop:-c/2},a.fadeInImageduration,"swing",function(){b("#Choco_bigImage").fadeTo(a.fadeInImageduration,1).height(c).width(h);if(!g){if(a.linkImages)for(var f=["Choco_right_arrow","Choco_left_arrow"],d=0;d<f.length;d++)hide=!1,"Choco_right_arrow"==f[d]&&a.currentImage==a.lastImage?(hide=!0,b("#"+f[d]).fadeOut(300)):"Choco_left_arrow"==f[d]&&0==a.currentImage&&(hide=!0,b("#"+f[d]).fadeOut(300)),hide||b("#"+
f[d]).fadeIn(a.fadeOutImageduration);b("#Choco_container_description").css("visibility","visible");b("#Choco_close").fadeIn(a.fadeInImageduration)}}).css("overflow","visible")}function v(){var c=a.currentImage+1,f=a.lastImage+1;b("#Choco_container_title").html(images[a.setIndex][a.currentImage].caption);b("#Choco_container_via").html(a.setTitle+a.separator1+c+a.separator2+f)}function m(a,b){return void 0===a?b:a}function k(){b("#Choco_overlay").fadeOut(900,function(){b("#Choco_overlay").remove()});
b("#Choco_content").fadeOut(500,function(){b("#Choco_content").remove()});a.currentImage=0}a=b.extend({container:b("body"),displayAsALink:!1,linkImages:!0,linksContainer:"Choco_links_container",overlayOpacity:.9,overlayColor:"#fff",fadeInOverlayduration:500,fadeInImageduration:500,fadeOutImageduration:500,vache:!0,separator1:" | ",separator2:"/",leftImg:"images/left.gif",rightImg:"images/right.gif",closeImg:"images/close.gif",loadingImg:"images/loading.gif",currentImage:0,setIndex:0,setTitle:"",lastImage:0},
a);p++;a.setIndex=p;images[a.setIndex]=[];this.each(function(c){0==c&&a.linkImages&&""==a.setTitle&&(a.setTitle=m(b(this).attr("rel")," "));b(this).each(function(){images[a.setIndex].displayAsALink=a.displayAsALink;images[a.setIndex][c]=[];images[a.setIndex][c].adress=m(b(this).attr("href")," ");images[a.setIndex][c].caption=m(b(this).attr("title")," ");a.displayAsALink||b(this).unbind("click").bind("click",{id:a.setIndex,nom:a.setTitle,i:c},q)})});for(var f=0;f<images[a.setIndex].length;f++)if(images[a.setIndex].displayAsALink)return 0==
b("#"+a.linksContainer).size()&&this.filter(":first").before('<ul id="'+a.linksContainer+'"></ul>'),b("#"+a.linksContainer).append('<li><a href="#" id="Choco_numsetIndex_'+a.setIndex+'" class="Choco_link">'+a.setTitle+"</a></li>"),e=this.parent(),b(this).remove(),""==b.trim(e.html())&&e.remove(),b("#Choco_numsetIndex_"+a.setIndex).unbind("click").bind("click",{id:a.setIndex,nom:a.setTitle,i:a.currentImage},q)}})(jQuery);
